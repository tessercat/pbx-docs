# Channel security

Clients must know a valid
per-channel login username (client ID) and password
before logging in (connecting a WebSocket)
to a channel.

Channel ID, client ID and password
are random UUIDs
generated by the Django `channels` app.

Client IDs are kept in per-channel
Django session variables,
and new Client objects are generated
when channel/client keys are missing
and when sessions expire.

Login username (client ID) and password
are delivered to the view
as values in DOM input elements.

The verto module
requires user configuration
to specify allowed event channels per user,
and since the `channels` app
auth request handler
adds only the channel UUID
to allowed event channels,
logged-in clients
are able to broadcast to a single channel only,
and can send peer-to-peer messages
only to other clients of that channel.

The verto module
disconnects (`verto.punt`) a logged-in client
when another client
re-uses the same auth credentials
*and session ID*,
but
[allows new connections](https://github.com/signalwire/freeswitch/issues/571)
if the session ID is different.
This seems like a huge security hole to me.

The verto module
provides no mechanism to disconnect clients,
so it's not currently possible
to "kick/ban" clients from a channel
unless I hack the `verto.punt` behaviour.

Once a WebRTC connection is established,
media streams
are transmitted directly peer-to-peer,
and the call server
has no knowledge of them at all.

I don't see how media streams
can be compromised
except at the endpoints themselves.

I also don't see a risk
in exposing the client ID login username,
but it's always possible
I'm missing something.

For peer-to-peer messages,
the verto module
inserts `sessid`
into the `MESSAGE` event `from_user` field,
and the target peer receives this value
in the received event's `msg.from` field.

When Peer objects
check expected peer ID
against the `from` field of incoming messages,
I'm fairly sure
it's not possible
for third parties
to interfere in peer-to-peer messaging dialogues.

Since username/password are easily discovered,
nefarious Internet denizens
can easily re-use
the pub/sub/peer-to-peer signal channel
for whatever purpose they devise,
but hopefully
I've minimized the possibility
of allowing such bad-faith actors
to interfere with
the channel layer's intended purpose
of providing a medium
to negotiate peer-to-peer
WebRTC voice and video calls.

I'm sure someone
with a more malevolent imagination
will eventually prove me wrong.
